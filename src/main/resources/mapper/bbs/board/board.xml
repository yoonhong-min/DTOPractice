<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.study.dtopractice.bbs.board.mapper.BoardMapper">

  <insert id="insertBoard" parameterType="Board" useGeneratedKeys="true" keyProperty="boardId">
    INSERT INTO BBS_BOARD (BOARD_CODE, BOARD_NAME)
    VALUES (#{boardCode},#{boardName})
  </insert>

  <select id="selectById" parameterType="Long" resultType="Board">
    SELECT
        BOARD_ID,
        BOARD_NAME,
        BOARD_CODE
    FROM BBS_BOARD
    WHERE BOARD_ID = #{boardId}
  </select>

  <select id="selectAllBoards" resultType="Board">
    SELECT
        BOARD_ID,
        BOARD_NAME,
        BOARD_CODE
    FROM BBS_BOARD
    WHERE USE_YN = 'Y'
    ORDER BY BOARD_ID ASC
  </select>
  
  <select id="existsByCodeExceptId" resultType="boolean">
    SELECT EXISTS (
        SELECT
            1
        FROM BBS_BOARD
        WHERE BOARD_CODE = #{code}
            AND BOARD_ID != #{boardId}
    )
  </select>

  <select id="existsByNameExceptID" resultType="boolean">
    SELECT EXISTS (
      SELECT
        1
      FROM BBS_BOARD
      WHERE BOARD_NAME = #{name}
        AND BOARD_ID != #{boardId}
    )
  </select>

  <select id="existBoardName" resultType="boolean" parameterType="String">
    SELECT EXISTS (
        SELECT
            1
        FROM BBS_BOARD
        WHERE BOARD_NAME = #{boardName}
    )
  </select>

  <select id="existBoardCode" resultType="boolean" parameterType="String">
    SELECT EXISTS (
      SELECT
        1
      FROM BBS_BOARD
      WHERE BOARD_CODE = #{boardCode}
    )
  </select>

  <update id="updateBoard" parameterType="Board">
    UPDATE BBS_BOARD
    <set>
      <if test="boardName != null">
        BOARD_NAME = #{boardName},
      </if>

      <if test="boardCode != null">
        board_code = #{boardCode},
      </if>

      <if test="useYn != null">
        USE_YN = #{useYn},
      </if>

      UPDATED_AT = NOW()
    </set>
    WHERE BOARD_ID = #{boardId}
  </update>
</mapper>